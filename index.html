<!DOCTYPE html>
<html lang="uk">

<head>
  <meta charset="UTF-8" />
  <title>ZX Palette</title>

  <script type="module" src="./libs/elements.js"></script>


  <style>
    html,
    body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      font-size: 12px;
    }

    body {
      display: flex;
      flex-direction: column;
      background-color: rgba(0, 0, 0, 0.25);
    }

    #invalidMsg {
      background: #500;
      position: absolute;
      color: #fff;
      padding: 6px 10px;
      font-size: 12px;
      text-align: center;
      font-family: "Inter", Helvetica;
      font-weight: 400;
      pointer-events: none;
      z-index: 1;
    }

    .hidden {
      display: none;
    }

    /* Preview area grows, scrolls if content overflows */
    #previewWrapper {
      flex: 1 1 auto;
      overflow: auto;
      border: none;
      margin: 2px;
      background: #111;
      color: #fff;
      font-size: 12px;
      text-align: center;
      font-family: "Inter", Helvetica;
      font-weight: 400;
      /* optional frame background */
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    #previewImg {
      image-rendering: pixelated;
      image-rendering: crisp-edges;
      /* Fallback лише для IE */
      -ms-interpolation-mode: nearest-neighbor;
      /* вже є */
      display: block;
      border: none;
      position: relative;
      z-index: 0;
    }

    /* Controls pinned at bottom */
    #controls {
      flex: 0 0 auto;
      padding: 2px 8px;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
    }

    button,
    option {
      font-family: "Inter", Helvetica;
      font-weight: 400;
      padding: 1px 2px;
      margin: 4px 8px;
      border-radius: 4px;
      cursor: pointer;
    }


    .selectFrame {
      height: 32px;
      background: #333;
      border-radius: 4px;
      border: 1px solid #3a3a3a;
      margin: 4px;
      align-items: center;
      justify-content: center;
      appearance: none;
    }

    select {
      margin: 4px 4px;
    }

    .control-button,
    .apply-btn,
    .import-export-btn {
      width: 32px;
      height: 32px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0px 8px 0px 8px;
      cursor: pointer;
    }

    /* groups */
    .group {
      flex: 0 0 auto;
    }

    .group> :not(sp-label) {
      margin: 0px 6px;
    }


    .sysScPick {
      width: 100px;
    }

    @media (prefers-color-scheme: dark),
    (prefers-color-scheme: darkest) {
      label {
        color: #E0E0E0;
      }
    }

    @media (prefers-color-scheme: light),
    (prefers-color-scheme: lightest) {
      .group {
        background-color: rgba(0, 0, 0, 0.0625);
      }

      .group>sp-label:not(.safe) {
        background-color: #E8E8E8;
      }
    }

    .icon {
      fill: currentColor;
    }
  </style>
</head>

<body>

  <div id="previewWrapper">
    <img id="previewImg" src="" alt="Preview" />
    <div id="invalidMsg" class="hidden">
      Only 8-bit RGB mode is supported, dimensions are multiples of 8 up to
      512x384
    </div>
  </div>

  <div id="controls" class="group">

    <sp-action-button class="control-button" id="zoomDown" icon-only aria-label="Зменшити масштаб">
      <img class="icon" src="img/zoom-minus.svg" alt="" />
    </sp-action-button>


    <sp-heading size="XXS" style="width: 10px;"><span id="zoomLabel">3x</span></sp-heading>


    <sp-action-button class="control-button" id="zoomUp" icon-only aria-label="Збільшити масштаб">
      <img class="icon" src="img/zoom-plus.svg" alt="" />
    </sp-action-button>

    <sp-action-button class="control-button" id="openPrefs" icon-only>
      <img class="icon" src="img/options.svg" alt="" />
    </sp-action-button>


    <!--
    <label>
      Sys Scale
      <div class="selectFrame">
      <select id="sysScaleSel">
        <option value="1.00">100%</option>
        <option value="1.145">115%</option>
        <option value="1.25">125%</option>
        <option value="1.5" selected>150%</option>
        <option value="1.75">175%</option>
        <option value="2.00">200%</option>
        <option value="2.25">225%</option>
        <option value="2.50">250%</option>
      </select>
      </div>
    </label>

    <sp-picker class="sysScPick" id="sysScaleSel1" label="System Scale" placeholder="Sys Scale">
      <sp-menu slot="options">
        <sp-menu-item value="1.00">100%</sp-menu-item>
        <sp-menu-item value="1.15">115%</sp-menu-item>
        <sp-menu-item value="1.25">125%</sp-menu-item>
        <sp-menu-item value="1.5">150%</sp-menu-item>
        <sp-menu-item value="1.75">175%</sp-menu-item>
        <sp-menu-item value="2.00">200%</sp-menu-item>
        <sp-menu-item value="2.25">225%</sp-menu-item>
        <sp-menu-item value="2.50">250%</sp-menu-item>
      </sp-menu>
    </sp-picker>
    -->

    <label>
      Dithering: 
      <div class="selectFrame">
        <select id="ditherAlgSel" style="width: 170px">
          <option value="checker2x1" style="font-size: 12px">Сheckerboard 2x1 </option>
          <option value="bayer2">Bayer 2×2</option>
          <option value="bayer4">Bayer 4×4</option>
          <option value="bayer">Bayer 8×8</option>
          <!--<option value="dotdiff">Dot diffusion (true)</option>-->
          <option value="fs">Floyd–Steinberg</option>
          <option value="jjn">Jarvis–Judice–Ninke</option>
          <option value="sierra3">Sierra-3</option>
          <option value="stucki">Stucki</option>
          <option value="burkes">Burkes</option>
          <option value="atkinson">Atkinson</option>
          <option value="bluenoise">Blue-noise</option>
          <option value="linediag7x7" selected>Line-diag 7×7</option>
          <option value="clustered">Clustered ordered</option>
          <!--<option value="random">Random threshold</option>-->
        </select>
      </div>
    </label>

    <sp-action-button id="applyBtn" style="width: 99px;">Paste</sp-action-button>

    <label>
      Amount
      <sp-slider id="ditherStrength" min="0" max="100" step="1" value="50" variant="filled"
        style="width: 180px; margin: 0px 4px;">
      </sp-slider>
      <span id="ditherLabel" style="width: 32px">50%</span>
    </label>

    <label>
      Bright
      <div class="selectFrame">
        <select id="brightModeSel">
          <option value="on">On</option>
          <option value="off">Off</option>
          <option value="auto" selected>Auto</option>
        </select>
      </div>
    </label>

    <label
      title="1. To activate the flash bit, put pixels in a layer named FLASH.&#10;2. If a block contains only one color, the second color will be taken from this layer.&#10;3. Hide the FLASH layer so it does not affect the visible result.">
      <sp-switch emphasized id="flashChk" label="Flash">Flash</sp-switch>
    </label>
    <sp-action-button id="saveScrBtn">Export</sp-action-button>
  </div>



  <!-- Модальний діалог -->
  <dialog id="prefsDialog" style="width: 240px; height: 456px; padding: 24px;">
    <sp-heading size="xs" style="margin:0">Select Your System Scale</sp-heading>
    <sp-divider size="m" style="margin:10px 0"></sp-divider>

    <!-- Меню з опціями -->
    <sp-body style="border: 1px solid rgba(255,255,255,0.1); width: 182px; height: 296px; padding: 8px 0px 0px 8px;">

      <sp-menu id="scalePicker" label="sys scale" style="width: 164px" selects="single">
        <sp-menu-item value="100">100%</sp-menu-item>
        <sp-menu-item value="125">125%</sp-menu-item>
        <sp-menu-item value="150">150%</sp-menu-item>
        <sp-menu-item value="175">175%</sp-menu-item>
        <sp-menu-item value="200">200%</sp-menu-item>
        <sp-menu-item value="225">225%</sp-menu-item>
        <sp-menu-item value="250">250%</sp-menu-item>
        <sp-menu-divider></sp-menu-divider>
        <sp-menu-item value="custom">
          <div style="display:flex; align-items:center;">
            <span>Custom</span>
            <sp-textfield disabled quiet id="customField" type="number" step="0.1" placeholder="100–500" min="100" max="500"
              style="width:70px; margin: 0px 8px; padding: 0;"></sp-textfield>
          </div>
        </sp-menu-item>
      </sp-menu>

    </sp-body>

    <!-- Кнопки підтвердження -->
    
      <sp-button-group style="margin: 10px;">
        <sp-button variant="secondary" style="margin-right:10px">
          Cancel
        </sp-button>
        <sp-button variant="primary">
          OK
        </sp-button>
      </sp-button-group>
    
  </dialog>

  <script src="main.js"></script>

</body>

</html>