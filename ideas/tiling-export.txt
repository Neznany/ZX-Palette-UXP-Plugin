у нас же розмір документа може бути від 8х8 до 512х384, логіка блоків при цьому не страждає, а от експорт не працює для нестарндартних розмірів, тому тбера добавити функцію нарощування ширини файла до 256, висоти до 192, та розбивку на більшу кількість файлів, якщо одна з сторін доку, або обидві більші за зормір scr. правила такі:

Вирівнювання та паддінг
– Якщо область тайла виходить за межі документа (і навпаки, якщо документ менший за 256×192), ми вставляємо відфільтроване зображення в верхній лівий кут тайла.
– Піксельна частина (перші 6144 байти) для всіх «за­лишкових» пікселів ставиться в 0.
– Атрибути (останні 768 байт) для блоків, що лежать за межами реальних даних, заповнюємо за замовчуванням:
INK = 7 (білий),
PAPER = 0 (чорний),
BRIGHT = 0, FLASH = 0.

Комбінований випадок нарощування+розбиття:
Для будь-якого документа з розмірами 8…512 по ширині та 8…384 по висоті ми робимо:

tilesX = ceil(W/256), tilesY = ceil(H/192).

Для кожної плитки (tx,ty) вирізаємо регіон [tx*256…tx*256+255]×[ty*192…ty*192+191].

Якщо ця область виходить за реальні межі, у правій частині (коли W>256), або внизу (коли H<192), або одночасно й там, і там (наприклад 512×64 → 2×1 плитки з паддінгом по висоті) — застосовуємо правила паддінгу з п.1.
Таким чином алгоритм автоматично «наростить» або «розіб’є» будь-який розмір від 8×8 до 512×384 на один чи кілька стандартних SCR-блоків 256×192.

Імена файлів
– Вихідний документ: "BaseName.scr".
– Якщо tilesX×tilesY > 1, для кожного тайла робимо:
BaseName_tx_ty.scr
де tx і ty — індекси від 0 до tilesX-1, tilesY-1.
Наприклад, для документа Landscape розміром 512×64 отримаємо дві плитки:
Landscape_0_0.scr
Landscape_1_0.scr
Ця логіка гарантує, що:

Ви завжди отримаєте правильний .scr блок 256×192 з верхнім-лівим вирівнюванням і заповненими нулями/атрибутами там, де даних немає;
Будь-який документ 8×8…512×384 розбивається або доповнюється правильно;
Імена файлів зрозумілі та унікальні.